<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>基于vue reactivity的 webcomponent框架</title>
    <!-- <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
    <script>
        // VConsole will be exported to `window.VConsole` by default.
        var vConsole = new window.VConsole();
    </script> -->
</head>

<body>
    <div id="routerroot">
        <div>
            <div class="column" ssr-id="e27c514b-c042-452a-aa66-dd48f3b024a3">
                <div class="text" ssr-id="87ac43fc-953f-41de-8341-307144074273">detail 页面 </div>
                <button class="button" ssr-id="87ac43fc-953f-41de-8341-307142074273"
                style="width: 100%; height: 30px; background-color: rgb(175, 238, 238);">button</button>
            </div>
        </div>
    </div>
    <script src="
https://cdn.jsdelivr.net/npm/virtualized-list@2.2.0/umd/virtualized-list.min.js
"></script>
    <script>
        globalThis.__ssrMode__ = true
    </script>
    <script type="importmap">
        {
          "imports": {
            "vue": "https://cdn.bootcdn.net/ajax/libs/vue/3.2.47/vue.esm-browser.js",
            "wle": "/assets/webele.js?v=35"
          }
        }
    </script>
    <script type="module" src="https://unpkg.com/@cloudfour/elastic-textarea/index.min.js"></script>
    <script type="module">
        import 'https://unpkg.com/xy-ui';

        import { reactive, onMounted, computed, watchEffect, ref, watch } from "vue"
        import { Nid, g, Column, Text, BaseVmControl, injectControl, useControl } from "wle";


        let rooterRootEle = document.getElementById("routerroot")


        class DomCotnrol extends BaseVmControl {
            title = ''
            get TextDetail() {
                return 'detail 页面 ' + this.title
            }
            setTitle(v) {
                this.title = v
            }
            action(e) {
                this.title = Nid()
            }
        }

        injectControl('vm')(DomCotnrol)

        let vm = useControl('vm')


        // let ele = document.createElement('div')
        // g.ssrc(Column().init(function (ele) {
        //     console.log('ssr');
        //     ; g.ssrc(Text(vm.TextDetail).init(function (ele) {
        //     }), function (ctx) {
        //         ctx.done(ele)
        //     });
        // }), function (ctx) { ctx.done(ele) })

        globalThis.vm = vm

        // document.querySelector('#routerroot').appendChild(ele)

        let jsonMap = {
            "87ac43fc-953f-41de-8341-307144074273": {
                "ssrRender": [
                    "Text",
                ]
            },
            ['87ac43fc-953f-41de-8341-307142074273']: {
                "ssrRender": [
                    "Button",
                ]
            }
        }

        let dataMap = {
            ['87ac43fc-953f-41de-8341-307144074273']: [vm.TextDetail],
            ['87ac43fc-953f-41de-8341-307142074273']: [{action: vm.action}]
        }

        globalThis.getscripts().run(jsonMap, dataMap)

    </script>
</body>

</html>